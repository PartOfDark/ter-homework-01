#cloud-init.yml
users:
 - name: ubuntu
   groups: sudo
   shell: /bin/bash
   sudo: ['ALL=(ALL) NOPASSWD:ALL']
   ssh-authorized-keys: "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC66m+735Opaa/Tb3Dzbg0Z8Trhz14HTKs2jFZvBia7d udjin@yoga7"
package_update: true
packages_upgrade: true
packages:
 - vim
runcmd: 
  - sed -i -e '/^PermitRootLogin/s/^.*$/PermitRootLogin no/' /etc/ssh/sshd_config
  - sed -i -e '/X11Forwarding/s/^.*$/X11Forwarding no/' /etc/ssh/sshd_config
  - sed -i -e '$UseDNS no' /etc/ssh/sshd_config
  - systemctl restart sshd
  - ufw default deny incoming
  - ufw default allow outgoing
  - ufw allow 22
  - echo "y" | ufw enable