# Домашнее задание к занятию "Основы Terraform. Yandex cloud"

### Цель задания

1. Создать свои первые ресурсы в облаке Yandex cloud с помощью terraform.
2. Освоить работу с переменными terraform

------

### Чеклист готовности к домашнему заданию

1. Зарегистрирован аккаунт в Yandex Cloud. Использован промокод на грант.
2. установлен инструмент yandex cli

------

### Инструменты/ дополнительные материалы, которые пригодятся для выполнения задания

1. ...
2. ...

### Задание 1

1. Изучите проект. В файле variables.tf уже созданы переменные для yandex provider.
2. Переименуйте файл personal.auto.tfvars_example в personal.auto.tfvars. Заполните переменные(идентификаторы облака, токен доступа). Благодаря .gitignore этот файл не попадет в публичный репозиторий.
3. Инициализируйте проект, примените изменения. 

В качестве ответа приложите скриншот ЛК Yandex cloud с созданной ВМ.
Что означает ```preemptible = true``` в параметрах ВМ?

------

### Задание 2

1. Изучите текущие переменные проекта и созданные с их помощью ресурсы.
2. Замените **значения** для ресурсов **yandex_compute_image** и **yandex_compute_instance** на **отдельные** переменные с префиксом **vm_web_** . Обязательно заполняйте тип переменной и ее описание. 
2. Создайте нужные переменные в файле variables.tf, заполните их **default** прежними значениями. 
3. Проверьте terraform plan, изменений быть не должно. 


------

### Задание 3
1. Создайте 2 файла: _vm.platform.web.tf и _vm.platform.db.tf. Перенесите переменные первой ВМ в файл _vm.platform.web.tf
2. Создайте вторую ВМ с именем **"netology-develop-platform-db"** ,  cores  = 4, memory = 2, core_fraction = 50. Заполните ее переменные в файле _vm.platform.db.tf с префиксом vm_db_ .
3. Общие переменные оставьте в файле variables.tf (строки 49,50)
4. Примените изменения

В качестве ответа приложите вывод команды ```terraform state list``` .

------

### Задание 4
1. Опишите в файле outputs.tf отдельные output , для каждой из ВМ с ее внешним IP адресом.
2. Примените изменения

В качестве ответа продемонстрируйте вывод в консоль значений ip-адресов с помощью команды ```terraform output```

------
### Задание 5
1. В файле locals.tf опишите в **одном** блоке имя каждой ВМ, используйте интерполяцию по примеру из лекции.
2. Замените переменные с именами ВМ из файла variables.tf на созданные вами local переменные.
3. Примените изменения

В качестве ответа запустите terraform console, сделайте скриншот команды и  содержимого local переменных

------
### Задание 6
1. Вместо использования 3-х переменных  ".._cores",".._memory",".._core_fraction" в блоке resources {...}, объедените их в одну переменную типа **map** с именами "vm_web_resources" и "vm_db_resources".
2. Так же поступите с блоком metadata{serial-port-enable, ssh-keys}, переменная должна быть общая для всех ВМ.
3. Удалите все, более не используемые переменные проекта.
4. Проверьте terraform plan, изменений быть не должно.

Для общего зачета создайте в github новый репозиторий. Создайте в нем ветку terraform-02, закомитьте в эту ветку свой финальный код проекта, пришлите ссылку на коммит. Удалите созданные ресурсы.


### Задание 7*(не обязательно)

Изучите сожержимое файла console.tf. Откройте terraform console, выполните следующие задания. Для зачета предоставье необходимые команды и их вывод.

1. Какой командой можно отобразить **второй** элемент списка test_list ?
2. Найдите длину списка test_list с помощью функции length(<имя переменной>)
3. Какой командой можно отобразить значение ключа admin из map test_map ?
4. Напишите interpolation выражение, результатом которого будет: "John is admin for production server based on ubuntu-20-04 with X vcpu, Y ram and Z virtual disks", используйте данные из переменных test_list, test_map, servers и функцию length() для подстановки.

В качестве ответа пришлите команду и вывод.

------
### Правила приема работы

1. Отправлена ссылка на документ (Google Doc) с выполненным заданием в личном кабинете
2. К документу настроены права доступа “Просматривать могут все в Интернете, у кого есть ссылка”.
3. Отправлена ссылка на репозиторий (github) с выполненным заданием в личном кабинете

------